{% extends 'base_assets.html' %}
{% load widget_tweaks %}
{% load asset_templatetags %}
{% block title %}Asset {{ object.asset_id }}{% endblock %}

{% block content %}

<div class="page-header">
  <h1>
      {% if edit and object %}
          Edit Asset: {{ object.asset_id }}
      {% else %}
          Asset: {{ object.asset_id }}
      {% endif %}
  </h1>
</div>
<form method="post" id="asset_update_form" action="{% url 'asset_update' pk=object.asset_id%}">
  {% include 'form_errors.html' %}
  {% csrf_token %}
  <input type="hidden" name="id" value="{{ object.id|default:0 }}" hidden=true>
  <div class="row">
    <div class="col-sm-12">
      {% include 'partials/asset_form.html' %}
    </div>
  </div>
  <div class="row">
    {% if perms.assets.asset_finance %}
    <div class="col-md-6">
      {% include 'partials/purchasedetails_form.html' %}
    </div>
    {%endif%}
    <div class="col-md-6"
    {% if not object.is_cable %} hidden="true" {% endif %} id="cable-table">
      {% include 'partials/cable_form.html' %}
    </div>
    <div class="col-md-4">
      {% include 'partials/parent_form.html' %}
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      {% include 'partials/asset_buttons.html' %}
    </div>
  </div>
</form>

{% if not edit %}
<div class="col-sm-12 text-right">
    <div>
        <a href="{% url 'asset_history' object.asset_id %}" title="View Revision History">
            Last edited at {{ object.last_edited_at|default:'never' }} by {{ object.last_edited_by.name|default:'nobody' }}
        </a>
    </div>
</div>
{% endif %}

{% endblock %}

{% block js%}
{% if edit %}
<script>
  function checkIfCableHidden() {
    if (document.getElementById("id_is_cable").checked) {
      document.getElementById("cable-table").hidden = false;
    } else {
      document.getElementById("cable-table").hidden = true;
    }
  }
  checkIfCableHidden();
</script>
{% endif %}
{% endblock %}
